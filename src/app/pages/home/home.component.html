<div class="home-container">
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="brand">
        <span class="brand-icon">üõπ</span>
        <h1 class="brand-title">Skate Market</h1>
      </div>

      <div class="user-menu">
        <div class="user-info">
          <div class="user-avatar">
            <span>{{ userName.charAt(0).toUpperCase() }}</span>
          </div>
          <div class="user-details">
            <p class="user-name">{{ userName }}</p>
            <p class="user-email">{{ userEmail }}</p>
          </div>
        </div>
        <button class="btn-logout" (click)="logout()">
          <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
          </svg>
          Cerrar Sesi√≥n
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Search Section -->
    <div class="search-section">
      <h2 class="section-title">Cat√°logo de Productos</h2>
      <div class="search-box">
        <svg class="search-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        <input
          type="text"
          class="search-input"
          placeholder="Buscar productos por nombre, tipo o descripci√≥n..."
          [value]="searchTerm()"
          (input)="buscarProductos($any($event.target).value)"
        />
      </div>
    </div>

    <!-- Loading State -->
    @if (loading()) {
      <div class="loading-container">
        <div class="spinner-large"></div>
        <p>Cargando productos...</p>
      </div>
    } @else if (noHayProductos) {
      <!-- No hay productos publicados -->
      <div class="empty-state">
        <svg class="empty-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
        </svg>
        <h3>No hay productos disponibles</h3>
        <p>A√∫n no hay productos publicados en la tienda.</p>
      </div>
    } @else if (noHayResultados) {
      <!-- No hay resultados de b√∫squeda -->
      <div class="empty-state">
        <svg class="empty-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <h3>No se encontraron coincidencias</h3>
        <p>No hay productos que coincidan con tu b√∫squeda: <strong>"{{ searchTerm() }}"</strong></p>
        <button class="btn-secondary" (click)="buscarProductos('')">
          Ver todos los productos
        </button>
      </div>
    } @else {
      <!-- Products Grid -->
      <div class="products-info">
        <p class="results-count">
          @if (searchTerm()) {
            Encontrados {{ productosFiltrados().length }} resultado(s) para "{{ searchTerm() }}"
          } @else {
            Mostrando {{ productosFiltrados().length }} producto(s)
          }
        </p>
      </div>

      <div class="products-grid">
        @for (producto of productosFiltrados(); track producto.id) {
          <div class="product-card" (click)="verDetalle(producto.id!)">
            <!-- Imagen del producto -->
            <div class="product-image">
              @if (producto.imagen_producto) {
                <img
                  [src]="producto.imagen_producto"
                  [alt]="producto.nombre"
                  class="img-producto">
              } @else {
                <div class="placeholder-imagen">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                  </svg>
                </div>
              }
            </div>

            <div class="product-header">
              <span class="product-type">{{ producto.tipo }}</span>
              @if (producto.cantidad === 0) {
                <span class="badge badge-out">Agotado</span>
              } @else if (producto.cantidad < 5) {
                <span class="badge badge-low">Pocas unidades</span>
              } @else {
                <span class="badge badge-available">Disponible</span>
              }
            </div>

            <div class="product-body">
              <h3 class="product-name">{{ producto.nombre }}</h3>
              <p class="product-description">{{ producto.descripcion }}</p>

              <div class="product-details">
                <div class="detail-item">
                  <svg class="detail-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" />
                  </svg>
                  <span>{{ producto.cantidad }} en stock</span>
                </div>
              </div>
            </div>

            <div class="product-footer">
              <div class="product-price">
                <span class="price-label">Precio:</span>
                <span class="price-value">${{ producto.precio.toFixed(2) }}</span>
              </div>
              <button class="btn-view">
                Ver detalles
                <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </button>
            </div>
          </div>
        }
      </div>
    }
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>&copy; 2025 Skate Market</p>
  </footer>
</div>
